# 사전 조사 (Pre-Work)

코드 수정/신규 기능 구현 전 **자동 실행**되는 종합 사전 조사 워크플로우입니다.
수동 호출도 가능합니다.

## 핵심 기능

| 기능 | 설명 |
|------|------|
| 솔루션 검색 | 오픈소스 우선, 웹/GitHub 검색 |
| 중복 확인 | 기존 이슈/PR 확인 |
| Make vs Buy 분석 | 직접 개발 vs 라이브러리 비교 |
| 사용자 승인 | 분석 결과 제시 후 승인 대기 |

## 자동 트리거

다음 요청 감지 시 자동 실행:
- 신규 기능: "추가", "구현", "개발", "만들어", "feature"
- 버그 수정: "수정", "고쳐", "fix", "버그"
- 리팩토링: "리팩토링", "개선", "최적화"

## 실행 단계

### Step 1: 솔루션 검색 (오픈소스 우선)

**검색 우선순위**:
1. **오픈소스 라이브러리** (MIT, Apache, BSD 라이선스)
2. 커뮤니티 검증 솔루션 (Stars > 500)
3. 직접 개발 (마지막 수단)

```bash
# GitHub 오픈소스 검색 (라이선스 필터)
gh search repos "[키워드]" --sort stars --limit 10 --license mit
gh search repos "[키워드]" --sort stars --limit 10 --license apache-2.0

# 활성 프로젝트 필터 (최근 6개월 내 업데이트)
gh search repos "[키워드]" --sort updated --limit 5
```

```
WebSearch: "[키워드] open source library 2024"
WebSearch: "[키워드] vs [대안] comparison github"
```

**오픈소스 평가 기준**:
| 기준 | 최소 요건 |
|------|----------|
| Stars | > 500 |
| 최근 커밋 | < 6개월 |
| 라이선스 | MIT, Apache 2.0, BSD |
| 이슈 해결률 | > 70% |
| 문서화 | README + 예제 |

### 병렬 검색 에스컬레이션

검색 결과가 **불충분**하면 `/parallel-research` 자동 제안:

| 트리거 조건 | 감지 방법 |
|------------|----------|
| 결과 부족 | GitHub 검색 결과 < 3개 |
| 품질 미달 | 평가 기준 통과 솔루션 0개 |
| 상충 정보 | 검색 결과가 서로 모순 |
| 복합 기술 | 키워드가 2개 이상 기술 조합 |
| 비교 요청 | "vs", "비교", "차이" 언급 |

```
⚠️ 검색 결과가 부족합니다. 병렬 리서치를 실행할까요? (Y/N)
→ Y: /parallel-research 자동 호출
→ N: 현재 결과로 진행
```

### Step 2: 중복 확인

```bash
# 관련 이슈 확인
gh issue list --search "[키워드]" --state all

# 관련 PR 확인
gh pr list --search "[키워드]" --state all
```

### Step 3: Make vs Buy 분석

| 옵션 | Stars | 최근 업데이트 | 장점 | 단점 | 추천 |
|------|-------|--------------|------|------|------|
| 직접 개발 | - | - | 완전 제어 | 시간 소요 | |
| 라이브러리 A | ⭐ 5k | 2024-01 | 안정적 | 의존성 | ✅ |
| 라이브러리 B | ⭐ 2k | 2024-03 | 가벼움 | 문서 부족 | |

### Step 4: 사용자 확인

```markdown
## 사전 조사 결과

### 솔루션 검색
- [검색 결과 요약]

### 중복 확인
- 관련 이슈: #123, #456 (또는 "없음")
- 관련 PR: #789 (또는 "없음")

### 권장 사항
- [직접 개발 / 라이브러리 A 사용]
- 이유: [근거]

**위 분석 결과를 확인하시고 진행 방향을 선택해주세요.**
```

## Light 모드 (버그 수정)

버그 수정 시에는 간소화된 버전 실행:
1. 중복 이슈/PR 확인만
2. Make vs Buy 분석 생략
3. 바로 구현 진행

## Override

사전 조사를 건너뛰려면:
- "PRE_WORK 없이 바로 구현해줘"
- "분석 생략하고 진행"

## 연동 에이전트

| 단계 | 에이전트 | 역할 |
|------|----------|------|
| 솔루션 검색 | `exa-search-specialist` | 고급 웹 검색 |
| 문서 검증 | `context7-engineer` | 최신 버전/문서 확인 |
| 중복 확인 | `github-engineer` | 이슈/PR 검색 |

## 관련 커맨드

| 커맨드 | 역할 |
|--------|------|
| `/pre-work` | 사전 조사 (현재) |
| `/fix-issue` | 이슈 기반 전체 워크플로우 |
| `/final-check` | 구현 후 최종 검증 |
