# MVP 및 단계별 프로덕트 수준 설계

**PRD**: PRD-0001 (VSeeFace 버튜버 기능 통합)
**Version**: 1.0.0
**Last Updated**: 2026-01-05
**Status**: In Progress

---

## 목차

1. [MVP 정의](#1-mvp-정의)
2. [Phase별 프로덕트 레벨 설계](#2-phase별-프로덕트-레벨-설계)
3. [배포 전략](#3-배포-전략)
4. [검증 기준](#4-검증-기준)
5. [위험 요소 및 완화 전략](#5-위험-요소-및-완화-전략)

---

## 1. MVP 정의

### 1.1 MVP 범위

**MVP (Minimum Viable Product)**는 VSeeFace 버튜버 기능의 핵심 가치를 검증할 수 있는 최소 기능 프로덕트입니다.

| 항목 | 내용 |
|------|------|
| **목표** | VSeeFace 아바타가 OBS에 표시되고, GitHub 이벤트(Commit)에 반응하는 최소 기능 구현 |
| **핵심 가치** | "AI 코딩 스트리밍에 생동감 있는 버튜버 아바타 추가" |
| **타겟 사용자** | 스트리머 본인 (1명) |
| **검증 목표** | 시청자 반응 긍정적인지 확인 (첫 방송 후 피드백) |

### 1.2 MVP 포함 기능 (Phase 1 + Phase 2)

#### ✅ 필수 기능

| 기능 | 설명 | Phase |
|------|------|-------|
| **VSeeFace 연동** | VMC Protocol을 통해 BlendShape 데이터 수신 | Phase 1 |
| **OBS 아바타 표시** | 320x180 영역에 아바타 표시, 투명 배경 | Phase 2 |
| **실시간 얼굴 추적** | 웹캠 기반 아바타 움직임 (30fps) | Phase 1 |
| **기본 레이아웃** | 1920x1080 OBS 오버레이 | Phase 2 |

#### ❌ MVP 제외 기능 (v2 이후)

| 기능 | 이유 | 예정 Phase |
|------|------|-----------|
| GitHub 이벤트 반응 | MVP에서는 수동 표정 변경으로 검증 | Phase 3 |
| 채팅 상호작용 | 핵심 가치 검증 후 추가 | Phase 4 |
| 아바타 교체 UI | 초기에는 고정 아바타 사용 | v2 |
| TTS 음성 합성 | 시각적 반응만으로 충분 | v3 |

### 1.3 MVP 완료 기준

| 항목 | 기준 | 측정 방법 |
|------|------|----------|
| **기술적 완성도** | VSeeFace 연동 + OBS 표시 성공 | 단위 테스트 + 수동 테스트 |
| **성능** | 60fps OBS 방송 유지 | OBS Stats 확인 |
| **안정성** | 10분 연속 방송 시 크래시 없음 | 스트레스 테스트 |
| **사용자 경험** | 아바타 설정 10분 이내 완료 | 타임 트래킹 |

### 1.4 MVP 배포 시점

**목표일**: D+5 (2026-01-09) - Phase 2 완료 시

**배포 조건**:
1. ✅ Phase 1 완료 (VMC Client 구현)
2. ✅ Phase 2 완료 (OBS 오버레이)
3. ✅ VRoid Hub 아바타 선택 완료
4. ✅ 10분 스트레스 테스트 통과

---

## 2. Phase별 프로덕트 레벨 설계

### 2.1 Phase 1: VSeeFace 기본 연동 (D+0 ~ D+3)

#### 프로덕트 목표

**"VSeeFace와 youtuber 프로젝트 간 데이터 통신 확립"**

#### 주요 기능

| 기능 | 사용자 스토리 | 기술 구현 |
|------|-------------|----------|
| **VMC Protocol 클라이언트** | 스트리머가 VSeeFace를 실행하면 자동으로 연결됨 | VMCClient 클래스, UDP 39539 포트 |
| **BlendShape 수신** | 웹캠 얼굴 추적 데이터가 실시간으로 수신됨 | osc 라이브러리, 30fps 수신 |
| **연결 상태 모니터링** | 연결 끊김 시 자동 감지 및 재연결 시도 | Health check (5초 간격) |

#### 프로덕트 산출물

```
packages/vtuber/
├── src/
│   ├── vmc-client.ts         # VMC Protocol 클라이언트
│   ├── types.ts              # VTuber 타입 정의
│   └── osc.d.ts              # osc 라이브러리 타입
├── tests/
│   └── vmc-client.test.ts    # 단위 테스트 (12개)
└── package.json

packages/shared/
└── src/types/index.ts        # WebSocket 메시지 타입

docs/
└── VSEFACE_SETUP.md          # 설치 가이드
```

#### 배포 가능 상태

- ✅ **단위 테스트**: 12/12 통과
- ✅ **통합 테스트**: VSeeFace 실행 시 연결 확인 (수동)
- ✅ **문서화**: VSEFACE_SETUP.md 작성 완료
- ⚠️ **아바타 준비**: VRoid Hub에서 아바타 다운로드 (수동)

#### 제한사항

- OBS 표시 불가 (Phase 2 필요)
- 표정 변경 API만 제공 (UI 없음)
- GitHub 이벤트 연동 없음 (Phase 3 필요)

---

### 2.2 Phase 2: OBS 오버레이 (D+4 ~ D+5)

#### 프로덕트 목표

**"시청자가 볼 수 있는 아바타 화면 완성"**

#### 주요 기능

| 기능 | 사용자 스토리 | 기술 구현 |
|------|-------------|----------|
| **1920x1080 레이아웃** | 시청자가 코드 화면과 아바타를 동시에 볼 수 있음 | HTML/CSS 그리드 레이아웃 |
| **아바타 프레임** | 우측 상단 320x180 영역에 아바타 표시 | VSeeFace Window Capture |
| **투명 배경** | 아바타만 표시, 배경 투명 | Chroma Key 또는 VSeeFace 투명 모드 |
| **연결 상태 표시** | VSeeFace 연결 상태를 시각적으로 표시 (🟢/🔴) | WebSocket 상태 메시지 |

#### 프로덕트 산출물

```
packages/stream-server/
└── overlay/
    ├── index.html            # 1920x1080 메인 레이아웃
    ├── styles.css            # 스타일시트
    └── vtuber-frame.html     # 아바타 프레임 (320x180)

docs/
└── OBS_SETUP.md              # OBS 설정 가이드 (신규)
```

#### 사용자 경험 시나리오

**방송 시작 시퀀스**:
1. 스트리머가 VSeeFace 실행 → 아바타 로드
2. OBS 실행 → Browser Source 자동 연결
3. 아바타가 우측 상단에 표시됨 (🟢 연결됨)
4. 스트리머가 고개를 끄덕이면 → 아바타도 따라함 (실시간)

**시청자 화면 구성**:
```
┌─────────────────────────────────────────┬──────────────┐
│        코드 편집기 화면 (VSCode)          │  아바타      │
│        1600 x 900                       │  320 x 180   │
│                                         │   [아바타]   │
│                                         │   🟢 연결됨   │
├─────────────────────────────────────────┤──────────────┤
│  [프로젝트 1]  [프로젝트 2]  [프로젝트 3]  │  활동 패널   │
│  멀티 프로젝트 활동 카드 (1600 x 180)     │  320 x 900   │
└─────────────────────────────────────────┴──────────────┘
```

#### MVP 달성 (Phase 2 완료 시)

✅ **MVP 완료**: Phase 2 완료 = MVP 배포 가능
- 시청자에게 아바타가 보임
- 실시간 얼굴 추적 동작
- 안정적인 방송 송출

#### 제한사항

- GitHub 이벤트 반응 없음 (수동으로 표정 변경 가능)
- 채팅 상호작용 없음
- 반응 애니메이션 없음

---

### 2.3 Phase 3: GitHub 연동 (D+6 ~ D+8)

#### 프로덕트 목표

**"코딩 활동을 아바타 반응으로 시각화"**

#### 주요 기능

| 기능 | 사용자 스토리 | 기술 구현 |
|------|-------------|----------|
| **Commit 반응** | Commit 푸시 시 아바타가 기쁜 표정 (2초) | handlePush() + wsManager.broadcast() |
| **PR Merge 반응** | PR 머지 시 아바타가 놀란 표정 (3초) | handlePullRequest() + expression='surprised' |
| **CI 성공/실패** | 테스트 성공 시 집중→기쁨, 실패 시 슬픔 | handleCheckRun() + 표정 시퀀스 |
| **반응 우선순위** | 여러 이벤트 동시 발생 시 우선순위 처리 | AvatarController 큐 시스템 |

#### 프로덕트 산출물

```
packages/vtuber/
└── src/
    ├── avatar-controller.ts     # 표정 제어 클래스
    └── reaction-mapper.ts       # 이벤트→표정 매핑

packages/stream-server/
└── src/
    ├── github-webhook.ts        # 아바타 반응 로직 추가
    └── vtuber-routes.ts         # VTuber API 엔드포인트

packages/stream-server/overlay/
└── reaction-overlay.html        # 반응 아이콘 (🎉, ❌ 등)
```

#### 사용자 경험 시나리오

**Commit 푸시 시**:
1. 스트리머가 `git push` 실행
2. GitHub Webhook → stream-server 수신 (0.5초)
3. wsManager.broadcast('vtuber:expression', { expression: 'happy', duration: 2000 })
4. 아바타가 2초간 기쁜 표정 😊
5. 우측 하단에 🎉 아이콘 2초간 표시

**테스트 실패 시**:
1. CI 실패 Webhook 수신
2. 아바타가 3초간 슬픈 표정 😢
3. 좌측 상단에 ❌ 아이콘 표시

#### 프로덕트 가치 증가

| 지표 | MVP (Phase 2) | Phase 3 완료 후 |
|------|--------------|----------------|
| 시청자 몰입도 | +10% | +30% (목표) |
| 채팅 참여도 | 기준값 | +20% |
| GitHub 활동 가시성 | 0% | 100% |

#### 제한사항

- 채팅 반응 없음 (Phase 4 필요)
- 표정 커스터마이징 불가 (v2)

---

### 2.4 Phase 4: 채팅 상호작용 (D+9 ~ D+12)

#### 프로덕트 목표

**"시청자와 아바타가 소통하는 인터랙티브 방송"**

#### 주요 기능

| 기능 | 사용자 스토리 | 기술 구현 |
|------|-------------|----------|
| **채팅 감정 분석** | 시청자가 "대박!"이라고 하면 아바타가 기뻐함 | youtuber_chatbot API 연동 |
| **긍정 반응** | 칭찬 메시지 → 아바타 happy (2초) | positive/excited → happy |
| **궁금증 반응** | 질문 메시지 → 아바타 surprised (2초) | curious → surprised |
| **스팸 방지** | 동일 감정 최소 5초 간격 | Rate limiting |

#### 프로덕트 산출물

```
packages/stream-server/
└── src/
    ├── chatbot-client.ts        # youtuber_chatbot API 클라이언트
    └── chat-handler.ts          # 채팅 WebSocket 핸들러

packages/vtuber/
└── src/
    └── reaction-mapper.ts       # mapChatEmotion() 함수 추가

tests/e2e/
└── vtuber.spec.ts               # E2E 테스트 (Playwright)
```

#### 사용자 경험 시나리오

**시청자 채팅 시**:
1. 시청자: "와! 코드 멋지네요!" (YouTube 채팅)
2. youtuber_chatbot 감정 분석: "positive" (0.5초)
3. WebSocket 브로드캐스트: 'vtuber:expression' → happy (0.2초)
4. 아바타가 2초간 기쁜 표정 😊
5. 우측 상단에 💬 아이콘 깜빡임

**스팸 방지**:
- "대박!" "대박!" "대박!" (연속 3회)
- → 첫 번째만 반응, 나머지는 무시 (5초 간격 적용)

#### 프로덕트 완성도

| 항목 | Phase 3 | Phase 4 (최종) |
|------|---------|---------------|
| **자동 반응** | GitHub만 | GitHub + 채팅 |
| **상호작용성** | 단방향 (스트리머→시청자) | 양방향 (시청자↔아바타) |
| **소통감** | 낮음 | 높음 (목표 +50%) |

#### 완료 기준

- ✅ E2E 테스트 통과 (Playwright)
- ✅ youtuber_chatbot 연동 성공
- ✅ 채팅 반응 지연 < 2초
- ✅ 문서화 완료 (README, API 가이드)

---

## 3. 배포 전략

### 3.1 배포 단계

| 단계 | 시점 | 배포 범위 | 검증 방법 |
|------|------|----------|----------|
| **Alpha** | Phase 2 완료 (D+5) | MVP 기능만 | 스트리머 본인 테스트 |
| **Beta** | Phase 3 완료 (D+8) | GitHub 연동 추가 | 첫 방송 (비공개/친구) |
| **RC** | Phase 4 완료 (D+12) | 채팅 상호작용 추가 | 공개 방송 (소규모) |
| **Production** | RC 검증 후 (D+14) | 전체 기능 | 정식 스트리밍 시작 |

### 3.2 Alpha 배포 (MVP)

**목표**: 기술적 안정성 검증

**체크리스트**:
- [ ] VSeeFace 연동 10분 이상 안정적
- [ ] OBS 60fps 유지
- [ ] 아바타 움직임 자연스러움
- [ ] 레이아웃 깨짐 없음

**Rollback 조건**:
- VSeeFace 연결 끊김 (3회 이상)
- OBS 프레임 드롭 > 5%
- 아바타 표시 오류

### 3.3 Beta 배포 (GitHub 연동)

**목표**: 사용자 반응 검증

**체크리스트**:
- [ ] Alpha 체크리스트 모두 통과
- [ ] GitHub 이벤트 반응 < 1초
- [ ] 반응 애니메이션 자연스러움
- [ ] 시청자 피드백 긍정적 (70% 이상)

**성공 지표**:
- 평균 시청 시간 > 10분
- 채팅 참여율 > 20%
- "아바타 재미있다" 피드백 > 5명

### 3.4 RC 배포 (채팅 연동)

**목표**: 프로덕션 준비 완료

**체크리스트**:
- [ ] Beta 체크리스트 모두 통과
- [ ] 채팅 반응 < 2초
- [ ] 스팸 방지 정상 작동
- [ ] E2E 테스트 100% 통과

**프로덕션 진입 조건**:
- 30분 연속 방송 크래시 없음
- 시청자 만족도 > 80%
- 구독자 전환율 > 10%

---

## 4. 검증 기준

### 4.1 Phase별 검증 기준

#### Phase 1: VSeeFace 기본 연동

| 항목 | 기준 | 측정 도구 |
|------|------|----------|
| **단위 테스트** | 12/12 통과 | Vitest |
| **BlendShape 수신** | 30fps 달성 | VMC Client 로그 |
| **연결 안정성** | 10분 동안 끊김 0회 | Health check 로그 |
| **메모리 사용** | < 50MB | Task Manager |

#### Phase 2: OBS 오버레이

| 항목 | 기준 | 측정 도구 |
|------|------|----------|
| **레이아웃 정확도** | 1920x1080 깨짐 없음 | 육안 검증 |
| **투명 배경** | 아바타만 표시 | OBS Window Capture |
| **OBS 성능** | 60fps 유지 | OBS Stats |
| **CPU 사용률** | < 30% (VSeeFace + OBS 합산) | Task Manager |

#### Phase 3: GitHub 연동

| 항목 | 기준 | 측정 도구 |
|------|------|----------|
| **반응 지연** | Webhook 수신 → 표정 변경 < 1초 | 타임스탬프 로그 |
| **통합 테스트** | GitHub 이벤트 100% 반응 | 수동 테스트 |
| **우선순위 큐** | 동시 이벤트 처리 정확 | 단위 테스트 |

#### Phase 4: 채팅 상호작용

| 항목 | 기준 | 측정 도구 |
|------|------|----------|
| **감정 분석 정확도** | > 80% | youtuber_chatbot 로그 |
| **반응 지연** | 채팅 → 표정 변경 < 2초 | E2E 테스트 |
| **E2E 테스트** | 15개 시나리오 통과 | Playwright |
| **스팸 방지** | 5초 간격 강제 | 단위 테스트 |

### 4.2 프로덕트 품질 지표

| 카테고리 | 지표 | 목표값 | 측정 주기 |
|---------|------|--------|----------|
| **성능** | OBS 프레임률 | 60fps | 실시간 |
| **안정성** | 크래시 빈도 | 0회 / 방송 | 방송 후 |
| **반응성** | GitHub → 표정 지연 | < 1초 | 매 이벤트 |
| **사용성** | 초기 설정 시간 | < 10분 | 첫 사용 시 |
| **만족도** | 시청자 긍정 피드백 | > 70% | 방송 후 설문 |

---

## 5. 위험 요소 및 완화 전략

### 5.1 기술적 위험

| 위험 요소 | 영향도 | 완화 전략 | 담당 Phase |
|----------|--------|----------|-----------|
| **VMC Protocol 불안정** | High | Fallback: VSeeFace API 직접 호출 | Phase 1 |
| **OBS 성능 저하** | Medium | Browser Source → Window Capture 전환 | Phase 2 |
| **GitHub Webhook 지연** | Low | 타임아웃 3초, 재시도 로직 | Phase 3 |
| **youtuber_chatbot 응답 느림** | Low | 타임아웃 2초, 기본 표정 유지 | Phase 4 |

### 5.2 프로덕트 위험

| 위험 요소 | 영향도 | 완화 전략 | 검증 시점 |
|----------|--------|----------|----------|
| **시청자 반응 부정적** | High | Beta 테스트 피드백 수집 → 개선 | Phase 3 완료 후 |
| **아바타 선택 어려움** | Medium | VRoid Hub 추천 리스트 제공 | Phase 1 |
| **설정 복잡도** | Medium | VSEFACE_SETUP.md 가이드 상세화 | Phase 2 |
| **방송 크래시** | High | 스트레스 테스트 (30분 연속) | 각 Phase 완료 후 |

### 5.3 일정 위험

| 위험 요소 | 영향 | 완화 전략 |
|----------|------|----------|
| **Phase 1 지연** | Phase 2~4 연쇄 지연 | Phase 1 우선순위 최상 |
| **아바타 선택 시간 소요** | Phase 1 지연 (1~2일) | 병렬 작업: 코딩 + 아바타 탐색 |
| **E2E 테스트 작성 시간** | Phase 4 지연 | Playwright 템플릿 사전 준비 |

---

## 6. 성공 지표 (North Star Metrics)

### 6.1 핵심 지표

| 지표 | 기준값 (현재) | MVP 목표 (Phase 2) | 최종 목표 (Phase 4) |
|------|-------------|-------------------|-------------------|
| **평균 시청 시간** | 5분 | 6.5분 (+30%) | 8분 (+60%) |
| **채팅 참여도** | 기준값 | +20% | +50% |
| **구독자 전환율** | 5% | 6% (+20%) | 8% (+60%) |
| **방송 몰입도** | - | 육안 평가 | 시청자 설문 > 80% |

### 6.2 부가 지표

| 지표 | 목표 | 측정 방법 |
|------|------|----------|
| **GitHub 활동 인지도** | 시청자가 Commit을 알아챔 | 채팅 반응 분석 |
| **아바타 선호도** | "아바타 귀엽다/멋지다" 피드백 > 10명 | 방송 후 댓글 |
| **기술적 안정성** | 크래시 0회 | 방송 로그 |

---

## 7. 다음 단계 (Post-MVP)

### v2 기능 (Phase 5 이후)

| 기능 | 우선순위 | 예상 일정 |
|------|---------|----------|
| **아바타 교체 UI** | Medium | D+20 |
| **표정 커스터마이징** | Low | D+25 |
| **TTS 음성 합성** | Low | v3 |
| **멀티 아바타 지원** | Low | v3 |

### 장기 비전

1. **AI 코딩 + 버튜버 융합 콘텐츠** 확립
2. **구독자 1000명** 달성 (6개월 목표)
3. **커뮤니티 주도 아바타 선택** (월간 투표)

---

## 참고 자료

- **PRD 문서**: `tasks/prds/0001-prd-vseface-integration.md`
- **Checklist**: `docs/checklists/PRD-0001.md`
- **설치 가이드**: `docs/VSEFACE_SETUP.md`
- **Phase 진행 현황**: `docs/checklists/PRD-0001.md` (실시간 업데이트)

---

**Last Updated**: 2026-01-05
**Version**: 1.0.0
**Status**: Phase 1 완료 (83.3%), Phase 2 진행 중
