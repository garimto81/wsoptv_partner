<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ title | default('Process Flowchart') }}</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Noto Sans KR', sans-serif;
      background: white;
      padding: 0;
      margin: 0;
      color: #242424;
      font-size: 16px;
    }

    .container {
      width: 540px;
      max-width: 540px;
      margin: 0;
      padding: 24px;
      background: white;
    }

    :root {
      --notion-text: #242424;
      --notion-text-secondary: #6B6B6B;
      --notion-text-muted: #A6A6A6;
      --notion-bg: #F7F7F5;
      --notion-border: #E6E6E3;
      --notion-blue: #87B5E1;
      --notion-green: #8FCC9E;
      --notion-purple: #BAA1D6;
      --notion-orange: #F0BB78;
    }

    .header {
      text-align: center;
      margin-bottom: 32px;
      padding-bottom: 20px;
      border-bottom: 1px solid var(--notion-border);
    }

    .header h1 {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 6px;
    }

    .header .subtitle {
      font-size: 16px;
      color: var(--notion-text-secondary);
    }

    /* 플로우차트 */
    .flowchart {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    /* 스텝 */
    .step {
      display: flex;
      align-items: flex-start;
      gap: 20px;
      width: 100%;
      max-width: 600px;
    }

    .step-number {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: var(--notion-bg);
      border: 2px solid var(--notion-border);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 15px;
      font-weight: 600;
      color: var(--notion-text-secondary);
      flex-shrink: 0;
    }

    .step-content {
      flex: 1;
      background: white;
      border: 1px solid var(--notion-border);
      border-radius: 8px;
      padding: 16px 20px;
    }

    .step-title {
      font-size: 17px;
      font-weight: 600;
      color: var(--notion-text);
      margin-bottom: 6px;
    }

    .step-desc {
      font-size: 15px;
      color: var(--notion-text-secondary);
      line-height: 1.5;
    }

    .step-icon {
      font-size: 18px;
      margin-right: 8px;
    }

    /* 스텝 타입별 스타일 */
    .step.start .step-number { background: #E0F4E5; border-color: var(--notion-green); color: #059669; }
    .step.end .step-number { background: #FBE6E1; border-color: #E99488; color: #dc2626; }
    .step.decision .step-content { border-left: 3px solid var(--notion-orange); }
    .step.action .step-content { border-left: 3px solid var(--notion-blue); }

    /* 연결선 */
    .connector {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      padding: 8px 0;
      padding-left: 16px;
    }

    .arrow-down {
      width: 2px;
      height: 28px;
      background: var(--notion-border);
      position: relative;
    }

    .arrow-down::after {
      content: '';
      position: absolute;
      bottom: -5px;
      left: -4px;
      border-left: 5px solid transparent;
      border-right: 5px solid transparent;
      border-top: 7px solid var(--notion-border);
    }

    /* 분기 */
    .branch {
      display: flex;
      gap: 24px;
      width: 100%;
      max-width: 600px;
      margin-left: 56px;
    }

    .branch-item {
      flex: 1;
      padding: 12px 16px;
      background: var(--notion-bg);
      border-radius: 6px;
      text-align: center;
    }

    .branch-label {
      font-size: 14px;
      font-weight: 600;
      color: var(--notion-text-muted);
      margin-bottom: 4px;
    }

    .branch-action {
      font-size: 15px;
      color: var(--notion-text-secondary);
    }

    /* 노트 */
    .note {
      background: #FFF8DB;
      border-left: 3px solid var(--notion-orange);
      padding: 12px 16px;
      margin: 16px 0;
      margin-left: 56px;
      border-radius: 0 6px 6px 0;
      font-size: 15px;
      color: var(--notion-text-secondary);
    }

    .note-icon {
      margin-right: 6px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>{{ title | default('Process Flowchart') }}</h1>
      <div class="subtitle">{{ subtitle | default('Step-by-step workflow') }}</div>
    </div>

    <div class="flowchart">
      {% for step in steps %}
      <div class="step {{ step.type | default('action') }}">
        <div class="step-number">{{ loop.index }}</div>
        <div class="step-content">
          <div class="step-title">
            {% if step.icon %}<span class="step-icon">{{ step.icon }}</span>{% endif %}
            {{ step.title }}
          </div>
          {% if step.description %}
          <div class="step-desc">{{ step.description }}</div>
          {% endif %}
        </div>
      </div>

      {% if step.branches %}
      <div class="connector">
        <div class="arrow-down"></div>
      </div>
      <div class="branch">
        {% for branch in step.branches %}
        <div class="branch-item">
          <div class="branch-label">{{ branch.label }}</div>
          <div class="branch-action">{{ branch.action }}</div>
        </div>
        {% endfor %}
      </div>
      {% endif %}

      {% if step.note %}
      <div class="note">
        <span class="note-icon"></span>{{ step.note }}
      </div>
      {% endif %}

      {% if not loop.last %}
      <div class="connector">
        <div class="arrow-down"></div>
      </div>
      {% endif %}
      {% endfor %}
    </div>
  </div>
</body>
</html>
